---
layout: post
title:  "MoA post"
date:   2021-02-22 17:15:08 +0530
category: ML
image: assets/images/images_medium_figure1.gif
---

## 1. What is MoA ?

In Scientific terminology.
 - In pharmacology, the term mechanism of action (MOA) refers to the specific biochemical interaction through which a drug substance produces its pharmacological effect.

 - A mechanism of action usually includes mention of the specific molecular targets to which the drug binds, such as an enzyme or receptor.

 - Receptor sites have specific affinities for drugs based on the chemical structure of the drug, as well as the specific action that occurs there.

In layman's term the procecss can be described as follows.

<!-- <img src="https://i.ibb.co/hDqgKwD/Screenshot-2021-01-29-at-8-35-02-AM.png" alt="Screenshot-2021-01-29-at-8-35-02-AM" border="0" height='500' width='500'> -->
<img src="https://i.ibb.co/YpKgFK7/8cbb2dd47630459add9d5647fd616663-1.png" alt="8cbb2dd47630459add9d5647fd616663-1" border="0" height='400' width='100%'>

When scientists are researching antibiotic treatments in the lab, they can see how effective different medications are at fighting specific bacteria. They study the cells closely and watch how they interact. Their observations reveal how the drug attacks and kills the bacteria. The methodoloy of attacking is inshort referred to as MoA.


### Importance of determining MoA
 - By knowing the interaction between a certain site of a drug and a receptor, other drugs can be formulated in a way that replicates this interaction, thus producing the same therapeutic effects. Indeed, this method is used to create new drugs.

 - It can help identify which patients are most likely to respond to treatment. Because the breast cancer medication trastuzumab is known to target protein HER2, for example, tumors can be screened for the presence of this molecule to determine whether or not the patient will benefit from trastuzumab therapy.

 - It can enable better dosing because the drug's effects on the target pathway can be monitored in the patient. Statin dosage, for example, is usually determined by measuring the patient's blood cholesterol levels.

### How to determine MoA

#### Existing methodologies :
 - **Microscopy-based methods**: 

    - **Procedure**: Bioactive compounds induce phenotypic changes in target cells, changes that are observable by microscopy, and which can give insight into the mechanism of action of the compound.

    - **Limitations**: Limitation of this approach is the time required to manually generate and interpret data, but advances in automated microscopy and image analysis software may help resolve this.

 - **Direct biochemical methods**: 

    - **Procedure**: Includes methods in which a protein or a small molecule, such as a drug candidate, is labeled and is traced throughout the body. This proves to be the most direct approach to find target protein that will bind to small targets of interest, such as a basic representation of a drug outline, in order to identify the pharmacophore of the drug. Due to the physical interactions between the labeled molecule and a protein, biochemical methods can be used to determine the toxicity, efficacy, and the mechanism of action of the drug.

    - **Limitations**: These control experiments have limitations, most notably the availability of related inactive compounds/labels.
    


## 2. LISH MoA problem description

### Aim:  
The aim of this challenge is to predict MoA of a drug.

<img src="https://i.ibb.co/xDmfZ6t/Screenshot-2021-02-22-at-9-30-49-PM.png" alt="Screenshot-2021-02-22-at-9-30-49-PM" border="0">

### Procedure Description: 
1. The drug iteracts with the cell. 
1. Cosequently certain genes of the cell's DNA get activated.
1. These genes express themselves by forming certain proteins and the proteins in turn carry out tasks like fighting with disease causing agents.

### Terminologies:
1. **Gene Expressions**: The process of going from DNA to a functional product is known as
**gene expression**.
A DNA molecule isn't just a long, boring string of nucleotides. Instead, it's divided up into functional units called **genes**. Each gene provides instructions for a functional product, that is, a molecule needed to perform a job in the cell. In many cases, the functional product of a gene is a protein. For example, Mendel's flower colour gene provides instructions for a protein that helps make coloured molecules (pigments) in flower petals.

1. **Cell viability** : Defined as the number of healthy cells in a sample, determines the amount of cells (regardless of phase around the **cell** cycle) that are living or dead, based on a total cell sample. Here in total we are performing experiments on 100 cells at a time.

### Features:

1. **Gene expressions** : As discussed above there will be 772 gene expression features, each denoted by "g-". Each gene feature represents the expression of one particular gene. Therefore, there are 772 individual genes being monitored in the assay

1. **Cell viability** : There are 100 cell viability features, each denoted by “c-“.

1. **Treatment/Control** : The cp_vehicle column indicates whether the experiment is a treatment (contains drug) or control (contains no drug). A common control vehicle is DMSO, which should have negligible biological effects.

1. **Dosage** : The cp_dose column indicates the dose level used in the experiment. Generally a higher dose will have a stronger effect.

1. **Timing** : The cp_time column indicates the amount of time elapsed between adding the drug and when the measurement was taken. The effect this has on the data will differ depending on the mechanism. For example, some drugs will have an irreversible effect that can still be seen 72 hours after dosing. Other drugs will have lost all effect by that point and may be indistinguishable from controls.

### Metric:
It is a multi label classification problem with metric as summation of log loss over each label. 

### Existing approaches:
Following are some of the approaches followed by competitors.

- One of the kernel trains 206 lightGBM models. Overall mean loss was 0.0162 . <br>
    [Link to notebook](https://www.kaggle.com/nroman/moa-lightgbm-206-models)

- Many kernels discussing the idea of stacked Neural Networks. One of the example is this link .<br>
    [Link to notebook](https://www.kaggle.com/c/lish-moa/discussion/204685)
    
   Particularly below architecture seems to be quite intuitive as it uses 1D CNN.
   
   <img src="https://i.ibb.co/r7crDmy/Screenshot-2021-02-22-at-10-12-12-PM.png" alt="Screenshot-2021-02-22-at-10-12-12-PM" border="0" width="600" height="400">
    
- Found a kernel which discusses a novel approach of using a t-sne plot as image feature for training CNN model.
    Steps are as follows:
    1. Get t-sne embeddings (2D) for each row .
    1. Plott-sne embedding.
    1. Apply convex hull algorithm on the extracted image. <br>

    [Link to notebook](https://www.kaggle.com/markpeng/deepinsight-transforming-non-image-data-to-images)


- References
    1. [Wikipedia MoA](https://en.wikipedia.org/wiki/Mechanism_of_action)
    2. [www.verywellmind.com](https://www.verywellmind.com/meaning-of-mechanism-of-action-in-health-care-425245)
    3. [www.cancer.go](https://www.cancer.gov/publications/dictionaries/cancer-terms/def/mechanism-of-action)


|Blog part |
|-------------------|
|2. [EDA on LISH MoA dataset]({{ site.baseurl }}{% post_url /MoA_inner_posts/2021-02-22-MoA_EDA %})|
|-------------------|
|3. [Feature Engineering and Baseline model for MoA]({{ site.baseurl }}{% post_url /MoA_inner_posts/2021-02-22-MoA_Feature_Eng_Baseline %})|
|-------------------|
|4. [ML techniques on MoA dataset]({{ site.baseurl }}{% post_url /MoA_inner_posts/2021-02-22-MoA_ML %})|
|-------------------|
|5. [DL techniques on MoA dataset]({{ site.baseurl }}{% post_url /MoA_inner_posts/2021-02-22-MoA_DL %})|

